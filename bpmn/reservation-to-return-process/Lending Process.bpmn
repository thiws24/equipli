<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:spiffworkflow="http://spiffworkflow.org/bpmn/schema/1.0/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="Definitions_96f6665" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="3.0.0-dev">
  <bpmn:collaboration id="Collaboration_1fk2m93">
    <bpmn:participant id="Participant_1xx4y8n" name="Lending" processRef="lending_process_59k0hpx" />
    <bpmn:correlationKey id="CorrelationKey_0rbym1o" name="MainCorrelationKey" />
  </bpmn:collaboration>
  <bpmn:process id="lending_process_59k0hpx" name="Lending Process" isExecutable="true">
    <bpmn:ioSpecification>
      <bpmn:dataInput id="reservation" name="Reservation" />
      <bpmn:dataOutput id="activereservation" name="Active Reservation" />
      <bpmn:inputSet>
        <bpmn:dataInputRefs>reservation</bpmn:dataInputRefs>
      </bpmn:inputSet>
      <bpmn:outputSet>
        <bpmn:dataOutputRefs>activereservation</bpmn:dataOutputRefs>
      </bpmn:outputSet>
    </bpmn:ioSpecification>
    <bpmn:laneSet id="LaneSet_04p3xom">
      <bpmn:lane id="Inventory-Manager" name="Inventory-Manager">
        <bpmn:flowNodeRef>Event_1vdiy0m</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Activity_1ikmzjd</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Activity_0krfv9o</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Event_10hbojy</bpmn:flowNodeRef>
      </bpmn:lane>
    </bpmn:laneSet>
    <bpmn:endEvent id="Event_1vdiy0m" name="Lending successfull">
      <bpmn:incoming>Flow_1xjtylu</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_1xjtylu" sourceRef="Activity_1ikmzjd" targetRef="Event_1vdiy0m" />
    <bpmn:serviceTask id="Activity_1ikmzjd" name="Update InventoryItem status">
      <bpmn:extensionElements>
        <spiffworkflow:serviceTaskOperator id="http/PutRequestV2" resultVariable="putResult">
          <spiffworkflow:parameters>
            <spiffworkflow:parameter id="url" type="str" value="&#34;https://inventory.equipli.de/categories/&#34;+str(reservation[&#34;categoryId&#34;])+&#34;/items/&#34;+str(reservation[&#34;itemId&#34;])" />
            <spiffworkflow:parameter id="headers" type="any" value="{&#34;Accept&#34;:&#34;application/json&#34;}" />
            <spiffworkflow:parameter id="data" type="any" value="{&#34;status&#34;: &#34;LENT&#34;}" />
            <spiffworkflow:parameter id="basic_auth_username" type="str" />
            <spiffworkflow:parameter id="basic_auth_password" type="str" />
          </spiffworkflow:parameters>
        </spiffworkflow:serviceTaskOperator>
        <spiffworkflow:postScript>activereservation = reservation
activereservation["lendingStatus"]= check_out_inventoryitem_message["checkout_confirmation"]


</spiffworkflow:postScript>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_0iji06c</bpmn:incoming>
      <bpmn:outgoing>Flow_1xjtylu</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_0iji06c" sourceRef="Activity_0krfv9o" targetRef="Activity_1ikmzjd" />
    <bpmn:receiveTask id="Activity_0krfv9o" name="Check-out InventoryItem" messageRef="check-out-inventoryitem" spiffworkflow:isMatchingCorrelation="true">
      <bpmn:extensionElements>
        <spiffworkflow:messageVariable>check_out_inventoryitem_message</spiffworkflow:messageVariable>
        <spiffworkflow:processVariableCorrelation>
          <spiffworkflow:propertyId>reservationId</spiffworkflow:propertyId>
          <spiffworkflow:expression>reservation["id"]</spiffworkflow:expression>
        </spiffworkflow:processVariableCorrelation>
        <spiffworkflow:processVariableCorrelation>
          <spiffworkflow:propertyId>categoryId</spiffworkflow:propertyId>
          <spiffworkflow:expression>reservation["categoryId"]</spiffworkflow:expression>
        </spiffworkflow:processVariableCorrelation>
        <spiffworkflow:processVariableCorrelation>
          <spiffworkflow:propertyId>itemId</spiffworkflow:propertyId>
          <spiffworkflow:expression>reservation["itemId"]</spiffworkflow:expression>
        </spiffworkflow:processVariableCorrelation>
        <spiffworkflow:processVariableCorrelation>
          <spiffworkflow:propertyId>reservationid</spiffworkflow:propertyId>
          <spiffworkflow:expression>reservation["id"]</spiffworkflow:expression>
        </spiffworkflow:processVariableCorrelation>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1609vhl</bpmn:incoming>
      <bpmn:outgoing>Flow_0iji06c</bpmn:outgoing>
    </bpmn:receiveTask>
    <bpmn:startEvent id="Event_10hbojy">
      <bpmn:outgoing>Flow_1609vhl</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:sequenceFlow id="Flow_1609vhl" sourceRef="Event_10hbojy" targetRef="Activity_0krfv9o" />
  </bpmn:process>
  <bpmn:message id="check-out-inventoryitem" name="check-out-inventoryitem" />
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Collaboration_1fk2m93">
      <bpmndi:BPMNShape id="Participant_1xx4y8n_di" bpmnElement="Participant_1xx4y8n" isHorizontal="true">
        <dc:Bounds x="-270" y="190" width="920" height="310" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Lane_085nnlm_di" bpmnElement="Inventory-Manager" isHorizontal="true">
        <dc:Bounds x="-240" y="190" width="890" height="310" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1vdiy0m_di" bpmnElement="Event_1vdiy0m">
        <dc:Bounds x="432" y="382" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="423" y="425" width="54" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_15ta2q8_di" bpmnElement="Activity_1ikmzjd">
        <dc:Bounds x="190" y="360" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1y30a4d_di" bpmnElement="Activity_0krfv9o">
        <dc:Bounds x="-30" y="360" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_10hbojy_di" bpmnElement="Event_10hbojy">
        <dc:Bounds x="-198" y="382" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="DataInput-388263309-1DI" bpmnElement="reservation">
        <dc:Bounds x="-168" y="215" width="36" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="-177" y="272" width="59" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="DataOutput-731653660-1DI" bpmnElement="activereservation">
        <dc:Bounds x="562" y="215" width="36" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="554" y="272" width="59" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_1xjtylu_di" bpmnElement="Flow_1xjtylu">
        <di:waypoint x="290" y="400" />
        <di:waypoint x="432" y="400" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0iji06c_di" bpmnElement="Flow_0iji06c">
        <di:waypoint x="70" y="400" />
        <di:waypoint x="190" y="400" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1609vhl_di" bpmnElement="Flow_1609vhl">
        <di:waypoint x="-162" y="400" />
        <di:waypoint x="-30" y="400" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
